<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å°ˆæ¡ˆè³‡æ–™è¼¸å…¥ç³»çµ±</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f6f9; padding: 20px; }
        .section-card { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h5 { border-bottom: 2px solid #0d6efd; padding-bottom: 10px; margin-bottom: 20px; color: #0d6efd; }
    </style>
</head>
<body>

<div class="container">
    <h2 class="mb-4 text-center">ğŸ“ æ–°å¢å°ˆæ¡ˆç¸¾æ•ˆè³‡æ–™</h2>
    <form id="projectForm">
        
        <div class="section-card">
            <h5>1. Project Definition (å°ˆæ¡ˆå®šç¾©)</h5>
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">Project ID</label>
                    <input type="text" class="form-control" id="project_id" value="DSEBDTW2400001">
                </div>
                <div class="col-md-3">
                    <label class="form-label">å¹´åº¦ (Year)</label>
                    <input type="number" class="form-control" id="year" value="2024">
                </div>
                <div class="col-md-3">
                    <label class="form-label">å°ˆæ¡ˆåç¨± (Name)</label>
                    <input type="text" class="form-control" id="name" value="å¤§å¹«å°_ç¯€èƒ½ç³»çµ±">
                </div>
                <div class="col-md-3">
                    <label class="form-label">æ¡ˆä»¶é¡å‹</label>
                    <select class="form-select" id="type">
                        <option value="è¨­å‚™äº¤ä»˜-å„²èƒ½">è¨­å‚™äº¤ä»˜-å„²èƒ½</option>
                        <option value="è¨­å‚™äº¤ä»˜-å…¶ä»–">è¨­å‚™äº¤ä»˜-å…¶ä»–</option>
                        <option value="ç¯€èƒ½æ”¹å–„" selected>ç¯€èƒ½æ”¹å–„</option>
                        <option value="ç¯€æ°´">ç¯€æ°´</option>
                        <option value="é¡§å•-ISO14064">é¡§å•-ISO14064</option>
                        <option value="é¡§å•-ISO14067">é¡§å•-ISO14067</option>
                        <option value="é¡§å•-ISO50001">é¡§å•-ISO50001</option>
                        <option value="é¡§å•-å…¶ä»–">é¡§å•-å…¶ä»–</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="section-card">
            <h5>2. åŸ·è¡Œç¸¾æ•ˆ (æˆæœ¬é¢)</h5>
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">é ä¼°äººåŠ›æˆæœ¬ ($)</label>
                    <input type="number" class="form-control" id="labor_cost_est" value="242450">
                </div>
                <div class="col-md-3">
                    <label class="form-label">å¯¦éš›äººåŠ›æˆæœ¬ ($)</label>
                    <input type="number" class="form-control" id="labor_cost_act" value="118614">
                </div>
                <div class="col-md-3">
                    <label class="form-label">é ä¼°ç®¡ç†æˆæœ¬ ($)</label>
                    <input type="number" class="form-control" id="mgmt_cost_est" value="113000">
                </div>
                <div class="col-md-3">
                    <label class="form-label">å¯¦éš›ç®¡ç†æˆæœ¬ ($)</label>
                    <input type="number" class="form-control" id="mgmt_cost_act" value="53085">
                </div>
            </div>
        </div>

        <div class="section-card">
            <h5>3. ç’°å¢ƒè²¢ç» & ç¢³æ¬Š</h5>
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="form-label">é ä¼°ç¯€é›»é‡ (kWh/yr)</label>
                    <input type="number" class="form-control" id="elec_save_est" value="1454269">
                </div>
                <div class="col-md-4">
                    <label class="form-label">ç¢³æ¬Šé¡åº¦ (å™¸)</label>
                    <input type="number" class="form-control" id="carbon_credit_amt" value="228">
                </div>
                <div class="col-md-4">
                    <label class="form-label">ç¢³æ¬Šç¾åƒ¹ (NTD)</label>
                    <input type="number" class="form-control" id="carbon_credit_price" value="3000">
                </div>
            </div>
        </div>

        <div class="text-center">
            <button type="button" class="btn btn-primary btn-lg" onclick="submitData()">é€å‡ºä¸¦è¨ˆç®—</button>
            <a href="dashboard.html" class="btn btn-secondary btn-lg">å‰å¾€å ±è¡¨é é¢</a>
        </div>
    </form>
</div>

<script>
    async function submitData() {
        // 1. æ”¶é›†è¡¨å–®æ•¸æ“š
        const data = {
            project_id: document.getElementById('project_id').value,
            year: parseInt(document.getElementById('year').value),
            name: document.getElementById('name').value,
            type: document.getElementById('type').value,
            labor_cost_est: parseFloat(document.getElementById('labor_cost_est').value) || 0,
            labor_cost_act: parseFloat(document.getElementById('labor_cost_act').value) || 0,
            mgmt_cost_est: parseFloat(document.getElementById('mgmt_cost_est').value) || 0,
            mgmt_cost_act: parseFloat(document.getElementById('mgmt_cost_act').value) || 0,
            elec_save_est: parseFloat(document.getElementById('elec_save_est').value) || 0,
            carbon_credit_amt: parseFloat(document.getElementById('carbon_credit_amt').value) || 0,
            carbon_credit_price: parseFloat(document.getElementById('carbon_credit_price').value) || 0
        };

        // 2. ç™¼é€åˆ°å¾Œç«¯ API
        try {
            const response = await fetch('http://127.0.0.1:8000/submit_project', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            
            if (response.ok) {
                alert('âœ… è³‡æ–™å„²å­˜æˆåŠŸï¼å¾Œç«¯å·²å®Œæˆè‡ªå‹•è¨ˆç®—ã€‚');
            } else {
                alert('âŒ ç™¼ç”ŸéŒ¯èª¤');
            }
        } catch (error) {
            console.error(error);
            alert('ç„¡æ³•é€£æ¥åˆ°å¾Œç«¯ï¼Œè«‹ç¢ºèª main.py æ˜¯å¦æœ‰åŸ·è¡Œã€‚');
        }
    }
</script>
</body>
</html>